#!/bin/sh

COMPOSITOR="/usr/bin/rootston"
ROOTSTON_INI="@pkgdatadir@/rootston.ini"

if [ -x @bindir@/phoc ]; then
  COMPOSITOR=@bindir@/phoc
elif [ -x /usr/bin/phoc ]; then
  COMPOSITOR=/usr/bin/phoc
elif [ -x @wlrootsdir@/rootston ]; then
  COMPOSITOR=@wlrootsdir@/rootston
elif [ -x @bindir@/rootston ]; then
  COMPOSITOR=@bindir@/rootston
elif [ -x /usr/lib/wlroots/rootston ]; then
  COMPOSITOR=/usr/lib/wlroots/rootston
fi

if [ -f "/etc/phosh/rootston.ini" ]; then
  ROOTSTON_INI=/etc/phosh/rootston.ini
fi

# Run gnome-session through a login shell so it picks
# variables from /etc/profile.d (XDG_*)
exec "${COMPOSITOR}" -C "${ROOTSTON_INI}" -E "bash -lc 'gnome-session --disable-acceleration-check --session=phosh'"
